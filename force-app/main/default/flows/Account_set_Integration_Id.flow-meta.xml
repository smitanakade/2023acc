<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>55.0</apiVersion>
    <assignments>
        <name>Set_Exact_Match_IAN</name>
        <label>Set Exact Match IAN</label>
        <locationX>50</locationX>
        <locationY>695</locationY>
        <assignmentItems>
            <assignToReference>$Record.GPMS_Exact_Duplicate_Match__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>ExactMatchACO_IAN</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_Account_ACO</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Exact_Match_IAN_Without_ARBN</name>
        <label>Match IAN Without ARBN</label>
        <locationX>314</locationX>
        <locationY>695</locationY>
        <assignmentItems>
            <assignToReference>$Record.GPMS_Exact_Duplicate_Match__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>ExactMatchACO_Not_IAN</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_Account_1</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Exact_Match_Not_IAN</name>
        <label>Set Exact Match Not IAN</label>
        <locationX>578</locationX>
        <locationY>575</locationY>
        <assignmentItems>
            <assignToReference>$Record.GPMS_Exact_Duplicate_Match__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>ExactMatchACO_Not_IAN</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_ACO_Account</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Exact_Match_Provider</name>
        <label>Set Exact Match Provider</label>
        <locationX>842</locationX>
        <locationY>455</locationY>
        <assignmentItems>
            <assignToReference>$Record.GPMS_Exact_Duplicate_Match__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>ExactMatchProvider</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_Account</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Exact_Match_TPO</name>
        <label>Set Exact Match TPO</label>
        <locationX>1106</locationX>
        <locationY>455</locationY>
        <assignmentItems>
            <assignToReference>$Record.GPMS_Exact_Duplicate_Match__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>ExactMatchTPO</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_TPO_Account</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>Check_Account_Record_Type_and_ABN</name>
        <label>Check Account Record Type and ABN</label>
        <locationX>875</locationX>
        <locationY>1223</locationY>
        <defaultConnector>
            <targetReference>UpdateAccount</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>ACO_and_ABN_is_Changed</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.ABN_Entity_Name__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <elementReference>$Record__Prior.ABN_Entity_Name__c</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record__Prior.ABN_Entity_Name__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_ABN_History_Record_Type</targetReference>
            </connector>
            <label>ACO and ABN is Changed</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_ARBN_Is_Null</name>
        <label>Check ARBN Is Null</label>
        <locationX>182</locationX>
        <locationY>575</locationY>
        <defaultConnector>
            <targetReference>Set_Exact_Match_IAN_Without_ARBN</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Null</defaultConnectorLabel>
        <rules>
            <name>Not_Null</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.ARBN__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Exact_Match_IAN</targetReference>
            </connector>
            <label>Not Null</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_Incorporation_Id_Type</name>
        <label>Check Incorporation Id Type</label>
        <locationX>380</locationX>
        <locationY>455</locationY>
        <defaultConnector>
            <targetReference>Set_Exact_Match_Not_IAN</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>NOT IAN</defaultConnectorLabel>
        <rules>
            <name>IAN</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Incorporation_ID_Type__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>IAN</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Check_ARBN_Is_Null</targetReference>
            </connector>
            <label>IAN</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_Record_Type</name>
        <label>Check Record Type</label>
        <locationX>875</locationX>
        <locationY>335</locationY>
        <defaultConnector>
            <targetReference>Check_Account_Record_Type_and_ABN</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>ACO</name>
            <conditionLogic>1 AND 2 AND 3 AND (4 OR 5 OR 6)</conditionLogic>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Aged_Care_Organisation</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Incorporation_ID__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Incorporation_ID_Type__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Incorporation_ID__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Incorporation_ID_Type__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record__Prior.Incorporation_ID__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Check_Incorporation_Id_Type</targetReference>
            </connector>
            <label>ACO</label>
        </rules>
        <rules>
            <name>Provider</name>
            <conditionLogic>(1 OR 2 OR 3) AND 4 AND 5</conditionLogic>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Approved_Provider</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Commonwealth_Home_Support_Programme</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>National_Aboriginal_and_Torres_Strait_Islander_Flexible_Aged_Care</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.ABN__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.ABN__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Exact_Match_Provider</targetReference>
            </connector>
            <label>Provider</label>
        </rules>
        <rules>
            <name>TPO</name>
            <conditionLogic>(1 OR 2 OR 3) AND 4 AND 5</conditionLogic>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Management_Company</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Administrative_Organisation</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Service_Delivery_Organisation</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.ABN__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.ABN__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Exact_Match_TPO</targetReference>
            </connector>
            <label>TPO</label>
        </rules>
    </decisions>
    <description>Create Update Flow on Account</description>
    <environments>Default</environments>
    <formulas>
        <name>ExactMatchACO_IAN</name>
        <dataType>String</dataType>
        <expression>{!$Record.RecordType.DeveloperName} + &apos; - &apos; + {!$Record.Incorporation_ID__c} + &apos; - &apos;+ TEXT({!$Record.Incorporation_ID_Type__c}) + &apos; - &apos; +{!$Record.ARBN__c}</expression>
    </formulas>
    <formulas>
        <name>ExactMatchACO_Not_IAN</name>
        <dataType>String</dataType>
        <expression>{!$Record.RecordType.DeveloperName} + &apos; - &apos; + {!$Record.Incorporation_ID__c} + &apos; - &apos;+ TEXT({!$Record.Incorporation_ID_Type__c})</expression>
    </formulas>
    <formulas>
        <name>ExactMatchProvider</name>
        <dataType>String</dataType>
        <expression>{!$Record.RecordType.DeveloperName} + &apos; - &apos; + {!$Record.ABN__c}</expression>
    </formulas>
    <formulas>
        <name>ExactMatchTPO</name>
        <dataType>String</dataType>
        <expression>&apos;Third Party Organisation&apos; + &apos; - &apos; + {!$Record.ABN__c}</expression>
    </formulas>
    <formulas>
        <name>IntegrationId</name>
        <dataType>String</dataType>
        <expression>CASE( {!$Record.RecordType.DeveloperName} ,
&apos;Aged_Care_Organisation&apos;,&apos;ACO-&apos;,
&apos;Approved_Provider&apos;,&apos;PRV-&apos;,
&apos;Management_Company&apos;,&apos;MCO-&apos;,
&apos;Administrative_Organisation&apos;,&apos;AOG-&apos;,
&apos;Auspicing_Organisation&apos;,&apos;ASP-&apos;,
&apos;Service_Delivery_Organisation&apos;,&apos;SDO-&apos;,
&apos;National_Aboriginal_and_Torres_Strait_Islander_Flexible_Aged_Care&apos;,&apos;PRV-&apos;,
&apos;Commonwealth_Home_Support_Programme&apos;,&apos;PRV-&apos;,
&apos;&apos;)+if(ISBLANK({!$Record.Oracle_ID__c}),{!$Record.Account_Number__c},TEXT({!$Record.Oracle_ID__c}))</expression>
    </formulas>
    <interviewLabel>Account: set Integration Id {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Account: set Integration Id</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordCreates>
        <name>Create_ABN_History</name>
        <label>Create ABN History</label>
        <locationX>743</locationX>
        <locationY>1463</locationY>
        <connector>
            <targetReference>UpdateAccount</targetReference>
        </connector>
        <inputAssignments>
            <field>ABN_Effective_Date__c</field>
            <value>
                <elementReference>$Flow.CurrentDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ABN_Name__c</field>
            <value>
                <elementReference>$Record__Prior.ABN_Entity_Name__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Account__c</field>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>RecordTypeId</field>
            <value>
                <elementReference>Get_ABN_History_Record_Type.Id</elementReference>
            </value>
        </inputAssignments>
        <object>GPMS_Account_History__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordLookups>
        <name>Get_ABN_History_Record_Type</name>
        <label>Get ABN History Record Type</label>
        <locationX>743</locationX>
        <locationY>1343</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Create_ABN_History</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>SobjectType</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>GPMS_Account_History__c</stringValue>
            </value>
        </filters>
        <filters>
            <field>DeveloperName</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>ABN_History</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>RecordType</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordUpdates>
        <name>Update_Account</name>
        <label>Update Account</label>
        <locationX>842</locationX>
        <locationY>575</locationY>
        <connector>
            <targetReference>Check_Account_Record_Type_and_ABN</targetReference>
        </connector>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Account_1</name>
        <label>Update Account</label>
        <locationX>314</locationX>
        <locationY>815</locationY>
        <connector>
            <targetReference>Check_Account_Record_Type_and_ABN</targetReference>
        </connector>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Account_ACO</name>
        <label>Update Account</label>
        <locationX>50</locationX>
        <locationY>815</locationY>
        <connector>
            <targetReference>Check_Account_Record_Type_and_ABN</targetReference>
        </connector>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_ACO_Account</name>
        <label>Update Account</label>
        <locationX>578</locationX>
        <locationY>695</locationY>
        <connector>
            <targetReference>Check_Account_Record_Type_and_ABN</targetReference>
        </connector>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_TPO_Account</name>
        <label>Update TPO Account</label>
        <locationX>1106</locationX>
        <locationY>575</locationY>
        <connector>
            <targetReference>Check_Account_Record_Type_and_ABN</targetReference>
        </connector>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>UpdateAccount</name>
        <label>UpdateAccount</label>
        <locationX>875</locationX>
        <locationY>1679</locationY>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Integration_ID__c</field>
            <operator>NotEqualTo</operator>
            <value>
                <elementReference>IntegrationId</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Integration_ID__c</field>
            <value>
                <elementReference>IntegrationId</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <start>
        <locationX>749</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Check_Record_Type</targetReference>
        </connector>
        <object>Account</object>
        <recordTriggerType>CreateAndUpdate</recordTriggerType>
        <triggerType>RecordAfterSave</triggerType>
    </start>
    <status>Active</status>
</Flow>
